# 工具链

本节就是使用脚手架生成器（yeoman）来创建一个脚手架模版，该模版集成了各个工具（链），可以生成一个带各种工具的generator

### 脚手架 -->generator

#### 1、YEOMAN 

社区比较流行的脚手架生成器。是generator的generator，通过yeoman可以去开发一个可以初始化项目、创建模版的工具

Url：https://yeoman.io/authoring/file-system.html

### 工具链



### 单元测试工具

最流行的单元测试工具：

Mocha：https://mochajs.org

Jest：https://www.jestjs.cn



解决在不能使用export且不能在dist目录中单元测试的方法：

​	babel-register : https://www.babeljs.cn/docs/babel-register



使用本机macha调用babel是会出现module not found的错误，这时可以调本地mocha，操作如下：

​	./node_modules/.bin/mocha --require @babel/register    + .babelrc文件要指定babel转换的版本



Package.json中默认有测试相关，且默认关联到本地node_modules下面，所以可以这样写

```json
{
  "name": "test-demo",
  "version": "1.0.0",
  "description": "",
  "main": "index.js",
  "scripts": {
    "test": "mocha --require @babel/register" //mocha测试命令的写法  终端中运行npm run test即可
  },
  "author": "",
  "license": "ISC",
  "dependencies": {
    "@babel/preset-env": "^7.15.0",
    "mocha": "^9.0.3"
  },
  "devDependencies": {
    "@babel/core": "^7.15.0",
    "@babel/register": "^7.15.3"
  }
}
```



#### 单元测试里最重要的概念：code coverage 

测试代码覆盖率的工具：nyc        https://www.npmjs.com/package/nyc

测试：

./node_modules/.bin/nyc ./node_modules/.bin/mocha --require @babel/register 或

```json
{
  "name": "test-demo",
  "version": "1.0.0",
  "description": "",
  "main": "index.js",
  "scripts": {
    "test": "nyc mocha --require @babel/register" //使用nyc来测试覆盖率
  },
  "author": "",
  "license": "ISC",
  "dependencies": {
    "@babel/preset-env": "^7.15.0",
    "mocha": "^9.0.3"
  },
  "devDependencies": {
    "@babel/core": "^7.15.0",
    "@babel/register": "^7.15.3",
    "nyc": "^15.1.0"
  }
}
```



在使用import 时要给babel和nyc互相添加插件

babel: babel-plugin-istanbul

npmjs.com/package/babel-plugin-istanbul

```
npm install --save-dev babel-plugin-istanbul
```

Nyc 中在 .nycrc中加入

```
{
	"extends": "@istanbuljs/nyc-config-babel"
}
```



```json
{
  "name": "test-demo",
  "version": "1.0.0",
  "description": "",
  "main": "index.js",
  "scripts": {
    "test": "mocha --require @babel/register",//使用npm run test来进行单元测试
    "coverage": "nyc mocha" //使用npm run coverage 来进行代码覆盖率测试
  },
  "author": "",
  "license": "ISC",
  "dependencies": {
    "@babel/preset-env": "^7.15.0",
    "mocha": "^9.0.3"
  },
  "devDependencies": {
    "@babel/core": "^7.15.0",
    "@babel/register": "^7.15.3",
    "@istanbuljs/nyc-config-babel": "^3.0.0",
    "babel-plugin-istanbul": "^6.0.0",
    "nyc": "^15.1.0"
  }
}
```

